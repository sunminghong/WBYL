<?php
if(!defined('ISWBYL')) exit('Access Denied');

class my extends ctl_base {

	public function index(){
		$this->set("title","我的地盘");	

		$this->display("home_my_index");
	}
		
	public function home_timeline(){
		$kuids=rq("kuid","");
		if (!$kuids) return "";

		$kuidarr=explode(",",$kuids);

		$ms=array();
		foreach($kuidarr as $kuid){
			$k=envhelper::parseKUID($kuid);
			$lfrom=$k['lfrom'];

			$api="openapi_".$lfrom;
			importlib($api);
			$api=new $api(); 

			$client=$api->getClient($kuid);	
			///print_r($api->getUserInfo($kuid));
			$ms  = $client->home_timeline(); // done	
						
		}
		echo json_encode($ms);
		exit;
	}
	
	public function public_timeline(){

		$kuids=rq("kuid","");
		if (!$kuids) return "";

		$kuidarr=explode(",",$kuids);

		$ms=array();
		foreach($kuidarr as $kuid){
			$k=envhelper::parseKUID($kuid);
			$lfrom=$k['lfrom'];

			$api="openapi_".$lfrom;
			importlib($api);
			$api=new $api(); 

			$client=$api->getClient($kuid);	
			///print_r($api->getUserInfo($kuid));
			$ms  = $client->home_timeline(); // done	
						
		}
		echo json_encode($ms);
		exit;
	}

}
?>
